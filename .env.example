# ============================================
# SecLabs Automaton - Environment Configuration
# ============================================
# Copy this file to .env and modify values for your deployment
# ============================================

# ====================
# APPLICATION SETTINGS
# ====================

# Application Environment
APP_NAME=SecLabs Automaton
APP_ENV=production  # development, staging, production
APP_DEBUG=false
APP_URL=https://your-domain.com
APP_TIMEZONE=UTC

# Secret Keys (CHANGE THESE IN PRODUCTION!)
SECRET_KEY=change-this-in-production-to-a-secure-random-string
JWT_SECRET=change-this-in-production-to-a-secure-random-string
ENCRYPTION_KEY=32-character-encryption-key-here-change

# Security
CORS_ORIGINS=https://your-domain.com,http://localhost:3000
RATE_LIMIT_PER_MINUTE=100
SESSION_TIMEOUT_MINUTES=1440  # 24 hours
MAX_FILE_SIZE_MB=100

# ====================
# DATABASE SETTINGS
# ====================

# MariaDB/MySQL Configuration
DB_HOST=localhost
DB_PORT=3306
DB_NAME=inseclabs_automaton
DB_USER=automaton
DB_PASSWORD=strong-database-password-here
DATABASE_URL=mysql+pymysql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# Database Pool Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ====================
# REDIS SETTINGS
# ====================

# Redis for Caching, Queues, and WebSockets
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=strong-redis-password-here
REDIS_DB=0
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Redis Cache Settings
REDIS_CACHE_TTL_SECONDS=3600
REDIS_QUEUE_NAME=inseclabs_tasks

# ====================
# STORAGE SETTINGS
# ====================

# File Storage Paths
TOOLS_PATH=/opt/inseclabs/tools
ARTIFACTS_PATH=/opt/inseclabs/artifacts
SCREENSHOTS_PATH=/opt/inseclabs/screenshots
REPORTS_PATH=/opt/inseclabs/reports
UPLOAD_PATH=/opt/inseclabs/uploads

# Storage Limits (in GB)
MAX_STORAGE_GB=100
MAX_ARTIFACT_RETENTION_DAYS=90
MAX_SCREENSHOT_RETENTION_DAYS=30

# ====================
# SCANNING SETTINGS
# ====================

# Scanning Defaults
DEFAULT_SCAN_PROFILE=standard
DEFAULT_TIMEOUT_SECONDS=300
MAX_CONCURRENT_SCANS=5
MAX_CONCURRENT_TOOLS_PER_SCAN=3

# Rate Limiting
MAX_REQUESTS_PER_SECOND=10
MAX_DNS_QUERIES_PER_SECOND=50
MAX_PORT_SCANS_PER_SECOND=1000

# Safety Settings
ENABLE_ACTIVE_SCANNING=false  # Must be explicitly enabled per scan
ENABLE_INTENSIVE_TOOLS=false  # Tools like dirsearch with heavy wordlists
AUTO_STOP_ON_OUT_OF_SCOPE=true
AUTO_STOP_ON_HIGH_RESOURCE=true

# ====================
# TOOL CONFIGURATION
# ====================

# Nuclei Configuration
NUCLEI_TEMPLATES_PATH=/root/nuclei-templates
NUCLEI_SEVERITY_FILTER=critical,high,medium
NUCLEI_RATE_LIMIT=150
NUCLEI_TIMEOUT=10

# Nmap Configuration
NMAP_TIMEOUT=600
NMAP_MAX_RETRIES=2
NMAP_TOP_PORTS=1000

# Subdomain Enumeration
SUBDOMAIN_TIMEOUT=180
ENABLE_PASSIVE_ONLY=true
MAX_SUBDOMAINS_PER_DOMAIN=10000

# ====================
# NOTIFICATIONS
# ====================

# Email Settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password
SMTP_FROM=security@your-domain.com
SMTP_TLS=true

# Notification Preferences
NOTIFY_ON_SCAN_COMPLETE=true
NOTIFY_ON_CRITICAL_VULN=true
NOTIFY_ON_SYSTEM_ALERT=true

# Slack Webhook (Optional)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/XXX/YYY/ZZZ
SLACK_CHANNEL=#security-alerts

# Discord Webhook (Optional)
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/XXX/YYY

# ====================
# MONITORING & LOGGING
# ====================

# Logging
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR
LOG_FILE=/var/log/inseclabs/automaton.log
LOG_MAX_SIZE_MB=100
LOG_BACKUP_COUNT=10

# Prometheus Metrics
PROMETHEUS_PORT=9090
ENABLE_METRICS=true
METRICS_UPDATE_INTERVAL=30

# Health Checks
HEALTH_CHECK_INTERVAL=60
TOOL_HEALTH_CHECK_INTERVAL=300

# ====================
# AUTHENTICATION & RBAC
# ====================

# JWT Settings
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24
JWT_REFRESH_EXPIRATION_DAYS=7

# OAuth (Optional)
OAUTH_ENABLED=false
OAUTH_GOOGLE_CLIENT_ID=
OAUTH_GOOGLE_CLIENT_SECRET=
OAUTH_GITHUB_CLIENT_ID=
OAUTH_GITHUB_CLIENT_SECRET=

# LDAP (Optional)
LDAP_ENABLED=false
LDAP_SERVER=ldap://ldap.your-domain.com
LDAP_BASE_DN=dc=your-domain,dc=com
LDAP_USER_DN=cn=users,dc=your-domain,dc=com

# ====================
# API & INTEGRATIONS
# ====================

# External APIs
SHODAN_API_KEY=
CENSYS_API_ID=
CENSYS_API_SECRET=
VIRUSTOTAL_API_KEY=
SECURITYTRAILS_API_KEY=
WHOISXML_API_KEY=
IPINFO_API_KEY=
GREYNOISE_API_KEY=

# GitHub Integration (for tool updates)
GITHUB_TOKEN=  # Personal access token for rate limits

# ====================
# DOCKER SETTINGS
# ====================

# Docker Network
DOCKER_NETWORK=inseclabs-network
DOCKER_HOST_IP=172.17.0.1

# Container Resources
CONTAINER_MEMORY_LIMIT=4g
CONTAINER_CPU_LIMIT=2.0
CONTAINER_MEMORY_RESERVATION=2g
CONTAINER_CPU_RESERVATION=1.0

# ====================
# BACKUP SETTINGS
# ====================

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=/opt/inseclabs/backups

# S3 Backup (Optional)
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_S3_BUCKET=inseclabs-backups
AWS_S3_REGION=us-east-1

# ====================
# ADVANCED SETTINGS
# ====================

# Proxy Configuration (if behind proxy)
HTTP_PROXY=
HTTPS_PROXY=
NO_PROXY=localhost,127.0.0.1

# Geolocation
MAXMIND_LICENSE_KEY=  # For IP geolocation

# AI/ML Features (Experimental)
ENABLE_AI_PRIORITIZATION=false
OPENAI_API_KEY=
AI_MODEL=gpt-4

# Custom Wordlists
CUSTOM_WORDLIST_PATH=/opt/inseclabs/wordlists
ENABLE_CUSTOM_WORDLISTS=false

# ====================
# DEVELOPMENT SETTINGS
# ====================

# Debug Features (Development Only)
ENABLE_DEBUG_TOOLBAR=false
ENABLE_SQL_LOGGING=false
ENABLE_MOCK_SCANS=false

# Test Credentials (Development Only)
TEST_USER_EMAIL=test@example.com
TEST_USER_PASSWORD=test123
TEST_ADMIN_EMAIL=admin@example.com
TEST_ADMIN_PASSWORD=admin123

# ============================================
# DO NOT MODIFY BELOW THIS LINE
# ============================================

# Internal Paths (Auto-configured)
PYTHONPATH=/app
PATH=/usr/local/go/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/inseclabs/tools

# Internal Services
INTERNAL_API_URL=http://backend:8000
INTERNAL_WEBSOCKET_URL=ws://backend:8000/ws
INTERNAL_METRICS_URL=http://prometheus:9090
